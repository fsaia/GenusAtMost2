# GenusAtMost2
This is a repository for Magma code related to the paper "Shimura curve Atkin--Lehner quotients of genus at most two" by Oana Padurariu and Frederick Saia.


## Main Files

- `dual_graphs.m`: The first two functions are heavily based on code by Jim Stankewicz for computing the dual graph of the special fiber at $p$ of the Shimura curve $X_0^{D}(N)/\langle w_p \rangle# over $\mathbb{Q}$, where $p \mid D$, $\gcd(D,N) = 1$, $N$ is squarefree, and $D$ is an indefinite quaternion discriminant (hence $D/p$ is a definite quaternion discriminant) over $\mathbb{Q}$. The remainder of the code in this file is dedicated to computing information about the dual graphs of general Atkin--Lehner quotients of $X_0^{D}(N)$ (including the trivial one) at $p \mid D$, including functions for computing Kodaira symbols in the $g=1$ case and for determining the existence of local points at primes $p \mid D$. 

- `hyperelliptic_star_candidate_checks.m`: Code for determining the star quotients $X_0^D(N)^*$ of genus at most $2$.

- `genus_le2_quotient_checks.m`: Code for determing the Atkin--Lehner quotients $X_0^D(N)/W$, with $W \leq W_0(D,N)$ not trivial, of genus at most $2$.

## Required Files

- `quot_genus.m`: Code for computing genera of Atkin--Lehner quotients of $X_0^D(N)$ assuming $D>1$. The calculation uses Riemann--Hurwitz along with counts of fixed points of Atkin--Lehner involutions from work of Ogg.

- `AL_identifiers.m`: Code for working with Atkin--Lehner subgroups of the automorphisms group of $X_0^D(N)$. In particular, this file contains code for going between lists of all elements of a subgroup and minimal length lists of generators, and for listing all subgroups of the Atkin--Lehner group $W_0(D,N)$.

- `known_gonalities.m`: Known lists of coprime pairs $(D,N)$ with $D>1$ so that the curve $X_0^D(N)$ has genus $0$ or $1$ or has gonality over $\mathbb{Q}$ or geometric gonality at most 3.

- `cond_disc_list_allO.m`: list of all (not just maximal) imaginary quadratic orders of class number up to $100$. The $i^\text{th}$ element is the complete list of sequences $[f,d_K] = [\text{conductor}, \text{fundamental disc}]$ for imaginary quadratic orders of class number $i$. Generated using list of maximal orders by M. Watkins. In this work, we only really use the first two elements of this list, giving the orders of class numbers $1$ and $2$, in the file `depth_1_CM_residue_field.m`.

- `depth_1_CM_residue_field.m`: The main function in this file is for computing the residue field of a given CM point on an Atkin--Lehner quotient of the form $X_0^D(N)/<w_m>$ with $N squarefree$, $D>1$, and $m>1$ a Hall Divisor of $DN$. This is done using Corollary 5.14 of Gonzalez--Rotger 2006. Part of our code in the main function, in particular the functionality for taking the correct fixed fields, and the function `ExtendAutomorphism` is borrowed from the file `CMfunctions.m` in the repository for Padurariu--Schembri 2023 [linked here](https://github.com/ciaran-schembri/Shimura/blob/main/CMfunctions.m). 


## Computed Lists

- `genus_0_stars.m`: The list of all $271$ pairs $(D,N)$ with $\gcd(D,N) = 1$ so that $X_0^D(N)^*$ has genus $0$.

- `genus_1_stars.m`: The list of all $276$ pairs $(D,N)$ with $\gcd(D,N) = 1$ so that $X_0^D(N)^*$ has genus $1$.

- `genus_2_stars.m`: The list of all $289$ pairs $(D,N)$ with $\gcd(D,N) = 1$ so that $X_0^D(N)^*$ has genus $2$.

- `genus_0_AL_quotients.m`: The list of all $779$ triples $[D,N,\text{gens}]$ such that, with $W \leq W_0(D,N)$ being generated by the $w_m$ for $m$ in gens, we have that $X_0^D(N)/W$ is a non-trivial quotient having genus $0$.

- `genus_1_AL_quotients.m`: The list of all $1352$ triples $[D,N,\text{gens}]$ such that, with $W \leq W_0(D,N)$ being generated by the $w_m$ for $m$ in gens, we have that $X_0^D(N)/W$ is a non-trivial quotient having genus $1$

- `genus_2_AL_quotients.m`: The list of all $1580$ triples $[D,N,\text{gens}]$ such that, with $W \leq W_0(D,N)$ being generated by the $w_m$ for $m$ in gens, we have that $X_0^D(N)/W$ is a non-trivial quotient having genus $2$
